(function(e){"use strict";function t(){this.data={}}function n(){this.listeners=new t}function r(e){setTimeout(function(){throw e},0)}function i(e){this.type=e}function s(e,t){i.call(this,e);this.data=t.data;this.lastEventId=t.lastEventId}function N(e,t){var n=Number(e)||t;return n<x?x:n>T?T:n}function C(e,t,n){try{if(typeof t==="function"){t.call(e,n)}}catch(i){r(i)}}function k(t,r){function z(){H=d;if(M!==null){M.abort();M=null}if(_!==0){clearTimeout(_);_=0}if(D!==0){clearTimeout(D);D=0}L.readyState=d}function W(e){var t=H===p||H===h?M.responseText||"":"";var n=null;if(H===h){var r=0;var o="";if(f){try{r=Number(M.status||0);o=String(M.getResponseHeader("Content-Type")||"")}catch(a){}}else{r=200;o=M.contentType}if(r===200&&w.test(o)){H=p;O=true;A=u;L.readyState=p;n=new i("open");L.dispatchEvent(n);C(L,L.onopen,n);if(H===d){return}}}if(H===p){if(t.length>P){O=true}var l=P-1;var E=t.length;while(++l<E){var S=t[l];if(q===v&&S==="\n"){q=m}else{if(q===v){q=m}if(S==="\r"||S==="\n"){if(R==="data"){B.push(U)}else if(R==="id"){j=U}else if(R==="event"){F=U}else if(R==="retry"){u=N(U,u);A=u}else if(R==="heartbeatTimeout"){x=N(U,x);if(_!==0){clearTimeout(_);_=setTimeout(I,x)}}U="";R="";if(q===m){if(B.length!==0){k=j;if(F===""){F="message"}n=new s(F,{data:B.join("\n"),lastEventId:j});L.dispatchEvent(n);if(F==="message"){C(L,L.onmessage,n)}if(H===d){return}}B.length=0;F=""}q=S==="\r"?v:m}else{if(q===m){q=g}if(q===g){if(S===":"){q=y}else{R+=S}}else if(q===y){if(S!==" "){U+=S}q=b}else if(q===b){U+=S}}}}P=E}if((H===p||H===h)&&(e||P>1024*1024||_===0&&!O)){H=c;M.abort();if(_!==0){clearTimeout(_);_=0}if(A>u*64){A=u*64}if(A>T){A=T}_=setTimeout(I,A);A=A*2+1;L.readyState=h;n=new i("error");L.dispatchEvent(n);C(L,L.onerror,n)}else{if(_===0){O=false;_=setTimeout(I,x)}}}function X(){W(false)}function V(){W(true)}t=String(t);var o=Boolean(a&&r&&r.withCredentials);var u=N(r?r.retry:NaN,1e3);var x=N(r?r.heartbeatTimeout:NaN,45e3);var k=r&&r.lastEventId&&String(r.lastEventId)||"";var L=this;var A=u;var O=false;var M=new l;var _=0;var D=0;var P=0;var H=c;var B=[];var j="";var F="";var I=null;var q=m;var R="";var U="";r=null;if(!S){D=setTimeout(function $(){if(M.readyState===3){X()}D=setTimeout($,500)},0)}I=function(){_=0;if(H!==c){W(false);return}if(navigator.onLine===false){_=setTimeout(I,500);return}if(E&&e.document&&e.document.readyState!=="complete"){_=setTimeout(I,100);return}M.onload=M.onerror=V;M.onabort=V;if(f){M.onreadystatechange=X}if(!S){M.onprogress=X}O=false;_=setTimeout(I,x);P=0;H=h;B.length=0;F="";j=k;U="";R="";q=m;var n=t.slice(0,5);if(n!=="data:"&&n!=="blob:"){n=t+((t.indexOf("?",0)===-1?"?":"&")+"lastEventId="+encodeURIComponent(k)+"&r="+String(Math.random()+1).slice(2))}else{n=t}M.open("GET",n,true);M.withCredentials=o;M.responseType="text";if(f){M.setRequestHeader("Accept","text/event-stream")}M.send(null)};n.call(this);this.close=z;this.url=t;this.readyState=h;this.withCredentials=o;this.onopen=null;this.onmessage=null;this.onerror=null;I()}function L(){this.CONNECTING=h;this.OPEN=p;this.CLOSED=d}t.prototype={get:function(e){return this.data[e+"~"]},set:function(e,t){this.data[e+"~"]=t},"delete":function(e){delete this.data[e+"~"]}};n.prototype={dispatchEvent:function(e){var t=String(e.type);var n=this.listeners;var i=n.get(t);if(!i){return}var s=i.length;var o=-1;var u=null;while(++o<s){u=i[o];try{u.call(this,e)}catch(a){r(a)}}},addEventListener:function(e,t){e=String(e);var n=this.listeners;var r=n.get(e);if(!r){r=[];n.set(e,r)}var i=r.length;while(--i>=0){if(r[i]===t){return}}r.push(t)},removeEventListener:function(e,t){e=String(e);var n=this.listeners;var r=n.get(e);if(!r){return}var i=r.length;var s=[];var o=-1;while(++o<i){if(r[o]!==t){s.push(r[o])}}if(s.length===0){n["delete"](e)}else{n.set(e,s)}}};s.prototype=i.prototype;var o=e.XMLHttpRequest;var u=e.XDomainRequest;var a=Boolean(o&&(new o).withCredentials!==undefined);var f=a;var l=a?o:u;var c=-1;var h=0;var p=1;var d=2;var v=3;var m=4;var g=5;var y=6;var b=7;var w=/^text\/event\-stream;?(\s*charset\=utf\-8)?$/i;var E=/AppleWebKit\/5([0-2][0-9]|3[0-4])[\.\s\w]/.test(navigator.userAgent);var S=Boolean(o&&(new o).sendAsBinary!==undefined);var x=1;var T=18e6;L.prototype=n.prototype;k.prototype=new L;L.call(k);if(l){e.EventSource=k}})(this)